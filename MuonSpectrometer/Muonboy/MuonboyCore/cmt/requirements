package MuonboyCore

author  Marc Virchaux <virchaux@hep.saclay.cea.fr>

use AtlasPolicy        AtlasPolicy-*
use AtlasFortranPolicy AtlasFortranPolicy-*
use MboyCoreEvt        MboyCoreEvt-*        MuonSpectrometer/Muonboy 

private
use GaudiInterface     GaudiInterface-*     External
use StoreGate          StoreGate-*          Control
use TrkRoad            TrkRoad-*            Tracking/TrkEvent
use GeoPrimitives      GeoPrimitives-*      DetectorDescription
use MboyAthEvt         MboyAthEvt-*         MuonSpectrometer/Muonboy 
use AmdcStand          AmdcStand-*          MuonSpectrometer/Amdcsimrec 
use MuonPatternFinderToolInterfaces MuonPatternFinderToolInterfaces-* MuonSpectrometer/MuonReconstruction/MuonPatternFinders/MuonPatternFinderTools
end_private

macro modules_option "" CMTv1&CMTr26 "-modules"
library MuonboyCore $(modules_option) \
-s=../mb_modules *.F90 \
-s=../cpp_glue *.cxx
apply_pattern installed_library

# DRQ: These two libraries appear to have some interdependencies between them so it is impossible
#      to build them without some unresolved symbols. It would be good for someone to take a
#      look at moving the code around between them to fix this.
private
macro_remove libraryshr_linkopts "" Darwin "-undefined error" asNeeded "-Wl,--no-undefined"
macro_append libraryshr_linkopts "" Darwin " -undefined suppress "
end_private
library MuonboyCoreUtil \
-s=../mb_xml *.F90 \
-s=../mb_gen_vol *.F90 \
-s=../mb_mat *.F90 \
-s=../mb_uti *.F90 \
-s=../mb_fit *.F90 \
-s=../mb_rec *.F90 \
-s=../mb_amd *.F90 \
-s=../mb_covmat *.F90 \
-s=../mb_bool *.F90 \
-s=../cpp_any *.F90  *.cxx \
-s=../mb_demo *.F90
apply_pattern named_installed_library library=MuonboyCoreUtil

private

macro CPP_TITLE "$(package)"
macro CPP_VERSION "v1"
macro CPP_NAME "$(version)"
macro CPP_CVER "$(version)"

# macro_append  f90flags "" Linux " -g "

macro use_pp_f90flags " $(define_time_and_date) -DCPP_VERS=$(q)'$(CPP_CVER)'$(q) -DCPP_TITLE_CH=$(q)'$(CPP_NAME)'$(q) -DATLAS_TYPE"

macro DOXYGEN_INPUT            "" Doxygen "../src ../$(package) ../doc ../share ../python ../cmt/fragments ../cpp_any ../mb_amd ../mb_bool ../mb_covmat ../mb_demo ../mb_gen_vol ../mb_mat ../mb_modules ../mb_rec ../mb_fit ../mb_uti ../mb_xml"
macro DOXYGEN_FILE_PATTERNS    "" Doxygen "*.cxx *.h *.py *.mk *.F90"


